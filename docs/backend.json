
{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User Profile",
      "description": "Extends the base Firebase Auth user with application-specific data like roles.",
      "type": "object",
      "properties": {
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "displayName": {
          "type": "string",
          "description": "User's public display name."
        },
        "role": {
          "type": "string",
          "description": "The authorization role of the user.",
          "enum": [
            "admin",
            "member"
          ]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the user profile was created."
        }
      },
      "required": [
        "email",
        "role",
        "createdAt"
      ]
    },
    "Project": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Project",
      "type": "object",
      "description": "Represents a project within the Grisalis Flow system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the project entity."
        },
        "name": {
          "type": "string",
          "description": "Name of the project."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the project."
        },
        "createdBy": {
            "type": "string",
            "description": "User ID of the project creator."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the project was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the project was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "name",
        "description",
        "createdBy",
        "createdAt",
        "updatedAt"
      ]
    },
    "ProjectMember": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ProjectMember",
      "type": "object",
      "description": "Represents the association between a user and a project, indicating their membership.",
      "properties": {
        "userId": {
          "type": "string",
          "description": "The ID of the user who is a member."
        },
        "projectId": {
          "type": "string",
          "description": "The ID of the project."
        },
        "role": {
          "type": "string",
          "enum": ["owner", "member"],
          "description": "The role of the member in the project."
        },
        "displayName": {
            "type": "string",
            "description": "The display name of the user at the time of adding."
        },
        "email": {
            "type": "string",
            "description": "The email of the user at the time of adding."
        }
      },
      "required": [
        "userId",
        "projectId",
        "role",
        "displayName",
        "email"
      ]
    },
    "Task": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Task",
      "type": "object",
      "description": "Represents a task within a project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the task entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N Task)"
        },
        "sprintId": {
          "type": "string",
          "description": "Reference to Sprint. (Relationship: Sprint 1:N Task). Can be null if the task is not in a sprint."
        },
        "parentId": {
          "type": "string",
          "description": "Reference to parent Task if this is a subtask."
        },
        "type": {
            "type": "string",
            "enum": ["task", "subtask"],
            "description": "The type of the item."
        },
        "title": {
          "type": "string",
          "description": "Name of the task."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the task."
        },
        "status": {
          "type": "string",
          "description": "Current status of the task (e.g., Backlog, To-do, In progress, Testing, Review, Done)."
        },
        "priority": {
            "type": "string",
            "description": "Priority of the task (e.g., low, medium, high)."
        },
        "assigneeId": {
          "type": "string",
          "description": "Reference to User assigned to the task. (Relationship: User 1:N Task)"
        },
        "createdBy": {
            "type": "string",
            "description": "User ID of the task creator."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the task was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the task was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "projectId",
        "type",
        "title",
        "status",
        "priority",
        "createdBy",
        "createdAt",
        "updatedAt"
      ]
    },
    "Sprint": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Sprint",
      "type": "object",
      "description": "Represents a sprint within a project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the sprint entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N Sprint)"
        },
        "name": {
          "type": "string",
          "description": "Name of the sprint."
        },
        "startDate": {
          "type": "string",
          "description": "Start date of the sprint.",
          "format": "date-time"
        },
        "endDate": {
          "type": "string",
          "description": "End date of the sprint.",
          "format": "date-time"
        },
        "status": {
            "type": "string",
            "description": "Status of the sprint (e.g., planning, active, completed)."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the sprint was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the sprint was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "projectId",
        "name",
        "startDate",
        "endDate",
        "status",
        "createdAt",
        "updatedAt"
      ]
    },
    "Bug": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Bug",
      "type": "object",
      "description": "Represents a bug reported for a project.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the bug entity."
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N Bug)"
        },
        "title": {
          "type": "string",
          "description": "Title of the bug."
        },
        "status": {
            "type": "string",
            "description": "Status of the bug (e.g., new, in_progress, resolved, closed)."
        },
        "priority": {
            "type": "string",
            "description": "Priority of the bug (e.g., low, medium, high, critical)."
        },
        "severity": {
          "type": "string",
          "description": "Severity level of the bug (e.g., Critical, High, Medium, Low, Enhancement)."
        },
        "description": {
          "type": "string",
          "description": "Detailed description of the bug."
        },
        "reproductionSteps": {
          "type": "string",
          "description": "Steps to reproduce the bug."
        },
        "evidenceUrl": {
          "type": "string",
          "description": "URL to an image or video showing the bug.",
          "format": "uri"
        },
        "reportedBy": {
            "type": "string",
            "description": "User ID of the user who reported the bug."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the bug was reported.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the bug was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "projectId",
        "title",
        "status",
        "priority",
        "severity",
        "description",
        "reproductionSteps",
        "reportedBy",
        "createdAt",
        "updatedAt"
      ]
    },
    "TimeLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "TimeLog",
      "type": "object",
      "description": "Represents a time entry logged by a user for a specific task.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the time entry entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N TimeEntry)"
        },
        "projectId": {
          "type": "string",
          "description": "Reference to Project. (Relationship: Project 1:N TimeEntry)"
        },
        "taskId": {
          "type": "string",
          "description": "Reference to Task. (Relationship: Task 1:N TimeEntry)"
        },
        "hours": {
          "type": "number",
          "description": "Duration of the time entry in hours."
        },
        "description": {
          "type": "string",
          "description": "Description of the work done."
        },
        "date": {
          "type": "string",
          "description": "Date of the time entry.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "projectId",
        "taskId",
        "hours",
        "date"
      ]
    },
    "WikiPage": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WikiPage",
      "type": "object",
      "description": "Represents a wiki page within the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the wiki page entity."
        },
        "title": {
          "type": "string",
          "description": "Title of the wiki page."
        },
        "slug": {
          "type": "string",
          "description": "URL-friendly slug for the wiki page."
        },
        "content": {
          "type": "string",
          "description": "Content of the wiki page (e.g., Markdown or HTML)."
        },
        "createdBy": {
            "type": "string",
            "description": "User ID of the page creator."
        },
         "lastEditedBy": {
            "type": "object",
            "description": "Information about the last user who edited the page.",
            "properties": {
                "uid": {"type": "string"},
                "displayName": {"type": "string"}
            },
            "required": ["uid"]
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the wiki page was created.",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "description": "Timestamp indicating when the wiki page was last updated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "title",
        "slug",
        "content",
        "createdBy",
        "lastEditedBy",
        "createdAt",
        "updatedAt"
      ]
    },
    "WikiPageVersion": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "WikiPageVersion",
      "type": "object",
      "description": "Represents a historical version of a wiki page.",
      "properties": {
        "versionId": {
            "type": "string"
        },
        "pageId": {
            "type": "string"
        },
        "title": {
          "type": "string"
        },
        "content": {
          "type": "string"
        },
        "createdBy": {
            "type": "string"
        },
         "lastEditedBy": {
            "type": "object",
            "properties": {
                "uid": {"type": "string"},
                "displayName": {"type": "string"}
            },
            "required": ["uid"]
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "updatedAt": {
          "type": "string",
          "format": "date-time"
        }
      },
      "required": [
        "versionId", "pageId", "title", "content", "createdBy", "lastEditedBy", "createdAt", "updatedAt"
      ]
    },
    "Notification": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Notification",
      "type": "object",
      "description": "Represents a notification for a user.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the notification entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N Notification)"
        },
        "message": {
          "type": "string",
          "description": "Message content of the notification."
        },
        "type": {
          "type": "string",
          "description": "Type of notification (e.g., task_assigned, comment_added, status_changed, bug_critical)."
        },
        "read": {
          "type": "boolean",
          "description": "Indicates whether the notification has been read by the user."
        },
        "link": {
            "type": "string",
            "description": "Link to the relevant entity."
        },
        "createdAt": {
          "type": "string",
          "description": "Timestamp indicating when the notification was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "message",
        "type",
        "read",
        "link",
        "createdAt"
      ]
    },
    "AuditLog": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AuditLog",
      "type": "object",
      "description": "Represents an audit log entry for tracking changes within the system.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the audit log entry."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User who performed the action."
        },
        "userName": {
            "type": "string",
            "description": "Display name of the user who performed the action."
        },
        "action": {
          "type": "string",
          "description": "Description of the action performed (e.g., task_moved, project_modified, user_created)."
        },
        "entity": {
          "type": "string",
          "description": "Type of entity affected by the action (e.g., Task, Project, User)."
        },
        "entityId": {
          "type": "string",
          "description": "Identifier of the entity affected by the action."
        },
        "details": {
          "type": "object",
          "description": "JSON object with additional details about the change."
        },
        "timestamp": {
          "type": "string",
          "description": "Timestamp indicating when the action was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "userName",
        "action",
        "entity",
        "entityId",
        "details",
        "timestamp"
      ]
    },
    "Comment": {
        "$schema": "http://json-schema.org/draft-07/schema#",
        "title": "Comment",
        "type": "object",
        "description": "Represents a comment on a task.",
        "properties": {
            "id": {"type": "string"},
            "text": {"type": "string"},
            "userId": {"type": "string"},
            "userName": {"type": "string"},
            "userAvatar": {"type": "string"},
            "createdAt": {"type": "string", "format": "date-time"}
        },
        "required": ["text", "userId", "userName", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "/userProfiles/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores application-specific user data, including roles."
    },
    "/projects/{projectId}": {
      "schema": {
        "$ref": "#/entities/Project"
      },
      "description": "Stores project information."
    },
    "/projects/{projectId}/members/{userId}": {
      "schema": {
        "$ref": "#/entities/ProjectMember"
      },
      "description": "Associates users with projects. The document ID is the user's UID."
    },
    "/tasks/{taskId}": {
      "schema": {
        "$ref": "#/entities/Task"
      },
      "description": "Stores tasks. Security rules are inherited from the project."
    },
     "/tasks/{taskId}/comments/{commentId}": {
      "schema": {
        "$ref": "#/entities/Comment"
      },
      "description": "Stores comments on tasks."
    },
    "/bugs/{bugId}": {
      "schema": {
        "$ref": "#/entities/Bug"
      },
      "description": "Stores bug reports. Security rules are inherited from the project."
    },
    "/sprints/{sprintId}": {
        "schema": {
            "$ref": "#/entities/Sprint"
        },
        "description": "Stores sprints. Security rules are inherited from the project."
    },
    "/timeLogs/{timeLogId}": {
      "schema": {
        "$ref": "#/entities/TimeLog"
      },
      "description": "Stores time entries for tasks."
    },
    "/wiki/{wikiPageId}": {
      "schema": {
        "$ref": "#/entities/WikiPage"
      },
      "description": "Stores wiki pages."
    },
    "/wiki/{wikiPageId}/versions/{versionId}": {
      "schema": {
        "$ref": "#/entities/WikiPageVersion"
      },
      "description": "Stores the historical versions of a wiki page."
    },
    "/notifications/{notificationId}": {
        "schema": {
            "$ref": "#/entities/Notification"
        },
        "description": "Stores user-specific notifications."
    },
    "/auditLogs/{auditLogId}": {
      "schema": {
        "$ref": "#/entities/AuditLog"
      },
      "description": "Stores audit logs for important system events."
    }
  }
}
